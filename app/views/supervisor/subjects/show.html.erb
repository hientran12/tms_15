<% if current_user.is_supervisor? %>
  <div id="subject-status">
    <% if @subject_progresses.count > 0 %>
      <%= link_to 'Finish subject',
            subject_progress_path(@subject.subject_progresses.first, course_id: @course.id,
            subject_id: @subject.id),
            method: :patch, data: {confirm: "Are you sure?"},
            class: "btn btn-warning" %>
    <% end %>
  </div>
<% else %>
  <div id="subject-status">
    <% if @subject_progress.status.nil? %>
      <%= link_to 'Start subject',
        new_subject_progress_path(subject_progress_id: @subject_progress.id,
        subject_id: @subject.id, course_id: @course.id), class: "btn btn-primary" %>
    <% elsif @subject_progress.status %>
      <%= link_to 'Finish subject', subject_progress_path(@subject_progress,
          subject_id: @subject.id, course_id: @course.id), 
          method: :patch, data: {confirm: "Are you sure?"},
          class: "btn btn-warning" %>
    <% else %>
      <b>Subject finished</b>
    <% end %>
  </div>
<% end %>

<div class="col-md-8">
  <div id="content">
    <h1><%= @subject.name %></h1>
    <p>
      <%= @subject.description %>
    </p>
    <%= link_to 'Edit subject', edit_supervisor_subject_path(@subject),
      remote: true, class: "btn btn-primary" %>
  </div>
</div>

<div class="form-horizontal">
  <div class="col-md-4">
    <h1>List tasks</h1>
    <p>
      <%= link_to "Show subject content", supervisor_subject_path(@subject), remote:true %>
    </p>
    <% @tasks.each do |task| %>
      <p>
        <%= link_to task.name, supervisor_task_path(task), remote:true %>
        <%= link_to 'Destroy', supervisor_task_path(task),
          method: :delete, data:{confirm: 'Are you sure?'}, 
          class: "btn btn-xs btn-warning" %>
      </p>
    <% end %>
    <%= link_to 'Add a task',
      new_supervisor_task_path(subject_id: @subject.id), 
      remote: true, class: "btn btn-primary" %>
  </div>
</div>